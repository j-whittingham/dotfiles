#!/usr/local/bin/fish
# luajit/luakit browser

#set vsn master
set vsn develop

log "... script installing luakit"
install libwebkit-dev libunique-dev libsqlite3-dev help2man lua-filesystem pkg-config
cd /data/depot/www/luakit
unzip -u luakit-$vsn.zip

cd luakit-$vsn
make clean
# make error may require: sed 's/help2man -N /help2man -N --no-discard-stderr /' Makefile >Makefile.sed && mv Makefile.sed Makefile
#LUA_PKG_NAME=luajit make USE_LUAJIT=1
make USE_LUAJIT=1 USE_UNIQUE=1 CC="cc -I/usr/include/glib-2.0"
#sudo LUA_PKG_NAME=luajit make install
sudo make install
# add system wide link library path
sudo ldconfig /usr/local/lib

sudo update-alternatives --verbose --force --install /usr/bin/gnome-www-browser \gnome-www-browser /home/shum/bin/luakit 100
sudo update-alternatives --verbose --force --install /usr/bin/x-www-browser \x-www-browser /home/shum/bin/luakit 100
sudo update-alternatives --set gnome-www-browser /home/shum/bin/luakit
sudo update-alternatives --set x-www-browser /home/shum/bin/luakit

