#!/usr/bin/env fish
# distro upgrade cycle

killall xscreensaver
sudo apt-get update

# aptitude tends to break if too many updates!
#sudo aptitude safe-upgrade && sudo aptitude full-upgrade
sudo apt-get upgrade
sudo apt-get dist-upgrade

# apt cleanup equivalent to aptitude
sudo apt-get autoremove
if [ -f /usr/bin/deborphan ]
    if [ (deborphan | wc -l) -gt 0 ]
        deborphan
        if-no "remove orphan packages"; or sudo apt-get remove (deborphan)
    end
end
sudo apt-get clean
sudo apt-get autoclean

# post upgrade corrections
touch ~/.apt-file.update; apt F
~/bin/install/crunchbang-4post-upgrade

!p xscreensaver; and xscreensaver -no-splash &
df -h
