#!/usr/bin/env fish
# systemd install from root shell mandatory

headline+ "install systemd kernel modules"

if [ $USER != root ]
  echo ".. systemd can only be installed as root user"
  exit
end

install systemd

echo
echo '.. systemd-sysv install requires entering "Yes, do as I say!" to complete'
echo
sleep 3s

install systemd-sysv

# hold systemd-sysv package or debian will try to remove it and replace with the old initscripts
echo systemd-sysv hold | dpkg --set-selections
sed '/^ExecStart=/s/%I/-a shum %I/' /lib/systemd/system/getty@.service >/etc/systemd/system/autologin@.service
# force enable for systemd upgrades
systemctl -f enable autologin@.service
systemctl disable getty@.service
