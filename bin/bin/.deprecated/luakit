#!/bin/sh

# Office
# ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

# ...................................................................... Browser

# luajit luakit
unset HTTP_PROXY
echo >> /tmp/luakit.log
# kill remote instance to own the shared sqlite databases
case $(hostname) in
  luna)   ssh monad "killall luakit" 2>>/dev/null ;;
  monad)  ssh luna "killall luakit" 2>>/dev/null ;;
esac

# check that resolv.conf hasn't been initialized on boot
[[ $(cat /etc/resolv.conf | wc -l) > 1 ]] || sudo cp -v ~/build/root/etc/resolv.conf.adsuck /etc/resolv.conf >> /tmp/luakit.log

trace "$(/usr/bin/luakit --version)" >> /tmp/luakit.log
/usr/bin/luakit $@ >> /tmp/luakit.log 2>&1

# java runtime errors
cat ~/hs_err_pid* >> /tmp/luakit.log 2>/dev/null
rm -f ~/hs_err_pid* 2>/dev/null
