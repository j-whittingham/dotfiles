#!/bin/sh

# X11 Dynamic Menu
# ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

# ......................................................................... Help

# man page
page=$(apropos . \
     | cut -d' ' -f1 \
     | sort -d \
     | uniq \
     | sed '1iherbstluftwm\nremind\nzshall' \
     | $(dmenu) -p 'Man Page' \
     | cut -d':' -f3-)

if [[ $page ]]; then
  if apropos . | cut -d' ' -f1 | grep -q "$page"; then
    # do not fork urxvt
    /usr/bin/urxvt -title "man $page" -name 'max' -e man "$page"

    hardcopy=$(echo -e 'no\nyes' | $(dmenu) -p "Print $page") || exit
    if [[ $hardcopy = yes ]]; then
      # see http://www.cyberciti.biz/tips/how-do-i-print-out-a-linux-man-or-info-page.html
      manpage=$(find /usr/share/man -name "$page.1.gz")
      [[ $manpage ]] && zcat $manpage | groff -man -Tps | lpr -P $PRINTER \
                     || notify "$page" "man1 page not found"
    fi
  fi
fi
