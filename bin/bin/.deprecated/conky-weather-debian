#!/bin/sh
# Fetch current debian weather icon for conkyrc display
# Insert ${texeci 3600 conky-weather-debian} in output section of conkyrc

distro=$(head -1 /etc/apt/apt.conf | sed 's/^.*"\(.*\)".*/\1/')
case $distro in
  backports)  distro=stable
              ;;
  sid)        distro=unstable
              ;;
  wheezy)     distro=stable
              ;;
  waldorf)    distro=stable
              ;;
  jessie)     distro=testing
              ;;
esac
wget http://edos.debian.net/weather/ -qO - \
  | sed -n -e "/distro=$distro&arch=amd64\"><img/p" \
  | awk '{ print $10 }' \
  | sed -e 's!.*="!http://edos.debian.net/weather/!' -e 's/"//' \
  | wget -i - -O ~/.debian-release-weather.png 2>/dev/null
