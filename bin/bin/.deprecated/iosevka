#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Dev
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ...................................................................... Iosevka

# Usage: iosevka [amphetype]

# upright='v-l-hooky v-i-hooky v-a-singlestorey v-g-singlestorey'
# italic='v-l-hooky v-i-hooky v-a-singlestorey v-g-singlestorey'
upright='v-l-hooky v-i-hooky v-a-singlestorey v-g-singlestorey v-brace-curly'
italic='v-l-hooky v-i-hooky v-a-singlestorey v-g-singlestorey v-brace-curly'

# build hooky [i l] single-storey [a g] character set
cd /net/depot
if [ -d Iosevka ] ;then
  cd Iosevka
  rm -rf build dist
  cp parameters.toml.original parameters.toml
  git pull origin master
else
  git clone https://github.com/be5invis/Iosevka.git
  cd Iosevka
  original parameters.toml
fi
# ensure node.js is uptodate
npm install

if [ $1 ] ;then
  amphetype=-amphetype
  sed -i -re "/^family =/s/'Iosevka'/'Iosevka-amphetype'/" \
    -e "/^leading =/s/= ([0-9]*)/= 1850/" \
    /net/depot/Iosevka/parameters.toml
else
  sed -i -re "/^family =/s/'Iosevka-.*'/'Iosevka'/" \
    -e "/^leading =/s/= ([0-9]*)/= 1250/" \
    /net/depot/Iosevka/parameters.toml
fi

make STYLE_UPRIGHT="$upright" STYLE_ITALIC="$italic"
rm -rf $HOME/.fonts/iosevka$amphetype
rm -rf $HOME/.fonts/iosevka$amphetype-slab
cp -rv dist/iosevka $HOME/.fonts/iosevka$amphetype
cp -rv dist/iosevka-slab $HOME/.fonts/iosevka$amphetype-slab
sudo fc-cache -fv

# vim: set ft=sh: #
